# iterated_prisoners_dilemma

こちらは、oTreeを用いた2人でのオンライン繰り返し囚人のジレンマを実施するためのプログラムです。

## 目次

- [概要](#概要)
- [始め方](#始め方)
- [インストール](#インストール)
- [使用方法](#使用方法)

## 概要

- [oTree](https://github.com/oTree-org/oTree)はDjangoをベースにした経済実験や心理学実験をPCを用いて実施するためのゲーム作成用オープンソースプラットフォームです。
本プログラムはこちらをベースに、各ページに制限時間をつけて、実験用にカスタマイズしたものになります。

## 始め方

このセクションでは、プロジェクトの要件と開発環境の設定方法について説明します。

### 前提条件

- Python 3.9.6 以上

## インストール

1. リポジトリをクローンまたはダウンロードします。

2. 必要なライブラリやモジュールをインストールします。
```bash
pip install -r requirements.txt
```

##　使用方法（ローカルホスト）

1. ディレクトリに入り以下コマンドを打ちます。
```bash
otree prodserver 8000
```
2.　Google Chromeで以下のにアクセスします。

- [http://localhost:8000/](http://localhost:8000/)

同一ネットワーク内であれば、他のPCからもアクセス可能です。

## 主要な機能
- 2人繰り返し囚人のジレンマゲームの実施
- 結果をcsv形式で出力

## ディレクトリ構造
- `main/`: 主要なスクリプトを含むディレクトリ
  - `gen_desire.py`: gptを使用し環境から欲求を生成するスクリプト
  - `gen_goal.py`: gptを使用し目標を生成するスクリプト
  - `generate.py`: OpenAI APIを使用してテキストを生成するスクリプト()
  - `desire.py`: 環境を入力として欲求を出力するスクリプト
  - `select_goal.py`: 欲求から目標を選択するスクリプト
  - `utilis.py`: ユーティリティ関数を含むスクリプト
  - `view.py`: 欲求変化のグラフや目的選択の出力をweb UIで表示するスクリプト
  - `main.py`: 環境を入力して欲求が変化し目的を出力するスクリプト．グラフも出力する
  
- `data/`: データファイルを含むディレクトリ
  - `desire_change_scores_v2.csv`: 環境によって変化する欲求変化のスコアcsvファイル
  - `desire_shihyou_v2.json`: ５段階欲求とその指標のjsonファイル

- `tests/`: 最初に遊んでいたテストファイルを含むディレクトリ
- `output/`: 出力ファイルを格納するディレクトリ
    - `goal_counts.json`: 欲求と場所と対応している目的のjsonファイル
    - `embedded_status_name.csv`: 環境のステータスを埋め込んだcsvファイル（未知の環境名でもベクトル化したものを保存するファイル）
    - `embedded_desire_change_scores.csv`: 環境のステータスを埋め込んだ欲求変化のスコアcsvファイル(スコアを生成した環境名のみのベクトルを保存するファイル)

- `exp/`: 実験結果のグラフとデータを含むディレクトリ
- `prompt/`: OpenAI APIを使用するためのプロンプトを含むディレクトリ


